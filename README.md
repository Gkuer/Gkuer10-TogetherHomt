# ëª¨ì…˜ì¸ì‹ì„ í™œìš©í•œ ìš°ë¦¬ íšŒì‚¬ ìš´ë™ì‹œí‚¤ê¸° SNS

<h1 align="center" style="max-width: 100%;">
  <img width="550" alt="Logo" src="README.assets/title.png" style="max-width: 100%;" /><br/>
  <a href="http://3.38.103.222">www.togetherhomt.com(ë°°í¬ì¤‘ì§€)</a>
</h1>

<h3 align="center">
 SSAFY 2í•™ê¸° ê³µí†µí”„ë¡œì íŠ¸ <br/></h3>

<p align="center">
  <b>22.1.5 ~ 22.2.18</b><br /></p>

<br>

## ğŸ’ğŸ» About Project

### ê²½í—˜í•˜ê³ , ì„±ì¥í•œ ê²ƒë“¤(2022.01 ~ 2022.02)

- JIRAë¥¼ í™œìš©í•œ ì—…ë¬´/ì¼ì • ê´€ë¦¬
- Git Flow í™œìš© ë° Git ì»¤ë°‹ ì»¨ë²¤ì…˜ ì ìš©
- ì™€ì´ì–´í”„ë ˆì„, ìš”êµ¬ì‚¬í•­ ëª…ì„¸
- RESTful API ì ìš©í•œ ìì› ëª…ì‹œ
- Docker, Jenkins, AWS(EC2)ë¥¼ í™œìš©í•œ CI/CD
- Notion, Discordì„ í†µí•œ ë¹„ëŒ€ë©´ ì»¤ë®¤ë‹ˆì¼€ì´ì…˜
- ì†Œë‚˜íë¸Œ, local-ë°°í¬ì„œë²„ ì„¤ì • ë¶„ë¦¬, ë„¤ì´ë°ì»¨ë²¤ì…˜



### ì‚¬ìš© ê¸°ìˆ 

- Spring Boot, JPA, Gradle, Java, Mysql
- Docker, Jenkins, AWS(EC2)ë¥¼ í™œìš©í•œ CI/CD



<br>

## **âœğŸ½** Overview

![ì„œë¹„ìŠ¤ ì•„í‚¤í…ì²˜](README.assets/architecture.png)

![erd](README.assets/erd.png)

<br>

## **ğŸ§—ğŸ»** JIRAë¥¼ í™œìš©í•œ ì—…ë¬´/ì¼ì • ê´€ë¦¬

![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2022-02-21 á„‹á…©á„’á…® 11.19.31](README.assets/jira1.png)

![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2022-02-22 á„‹á…©á„Œá…¥á†« 12.31.55.png](README.assets/jira2.png)



### ìŠ¤í”„ë¦°íŠ¸

- ì¼ì£¼ì¼ ë‹¨ìœ„ë¡œ ì§„í–‰
- ì›”ìš”ì¼ì— íšŒì˜
- ì§„í–‰ìƒí™©, ê³„íšì„ ì¢…í•©
- BE/FE íŒ€ë³„ ìƒì˜
- Backlog ì‘ì„±

### Epic

- ì£¼ìš” ê¸°ëŠ¥ìœ¼ë¡œ êµ¬ì„±
- ìœ ì €, í”¼ë“œ, ê²€ìƒ‰, ìš´ë™, ë§ˆì´í˜ì´ì§€, ì–´ë“œë¯¼, ë””ìì¸, ë¦¬íŒ©í† ë§, ë°°í¬, ê¹ƒ, ë°œí‘œ

### Story

- [FE / BE]ë¥¼ ì•ì— ë¶™ì—¬ ì•Œì•„ë³´ê¸° ì‰½ê²Œ êµ¬ì„±
- Descriptionì— ìì„¸í•œ ê³„íš ì„¤ëª… ë° ì‚¬ìš©ê¸°ìˆ  ëª…ì‹œ

### Subtask

- ì›”ìš”ì¼ íšŒì˜ ë•Œ í•  ì¼ì´ ì •í•´ì§€ì§€ ì•Šì•˜ì„ ë•Œ,
  - ìˆ˜ 1, 2, 3 ì´ëŸ° ì‹ìœ¼ë¡œ Story ì‘ì„±,
    ì´í›„ì— Subtaskë¡œ ëª…ì‹œ
- Storyì—ì„œ ì¶”ê°€ë¡œ ì„¸ë¶€ê¸°ëŠ¥ í‘œí˜„í•  ë•Œ ì‚¬ìš©

<br>

## **ğŸš´ğŸ»â€â™‚ï¸**Â Git Flow í™œìš© ë° Git ì»¤ë°‹ ì»¨ë²¤ì…˜ ì ìš©

![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2022-02-22 á„‹á…©á„Œá…¥á†« 12.18.26](README.assets/git.png)

### Commit ì»¨ë²¤ì…˜

- [ ì»¤ë°‹ íƒ€ì… ] : [ë‚´ìš©] (Option : [#Jira])ìœ¼ë¡œ í†µì¼
    - FEAT, FIX, REFACTOR ...
    - í•˜ë‚˜ì˜ ì‘ì—…, í•˜ë‚˜ì˜ ì»¤ë°‹

### Branch ì „ëµ

- master
  - hotfix
  - develop
    - feature
      - front / back
        - ì„¸ë¶€ ê¸°ëŠ¥

<br>

## ğŸ“„ ì™€ì´ì–´í”„ë ˆì„ & ìš”êµ¬ì‚¬í•­ ëª…ì„¸

![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2022-02-23 á„‹á…©á„Œá…¥á†« 1.22.51](README.assets/wireframe.png)![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2022-02-23 á„‹á…©á„Œá…¥á†« 1.24.53](README.assets/api.png)

<br>

### ì™€ì´ì–´í”„ë ˆì„

- ì£¼ë¡œ í”„ë¡ íŠ¸ì—ì„œ ì œì‘, í˜‘ì—…í•˜ê³  êµ¬ì„±í•˜ëŠ” ë° ë§ì€ ë„ì›€
  - â€˜ì–´ëŠ ê¸°ëŠ¥ì´ ë“¤ì–´ê°€ì•¼í•˜ê³ , ì–´ë–¤ ë°ì´í„°ê°€ í•„ìš”í•˜ê² ë‹¤â€™ë¼ëŠ” ê²ƒì„ ìœ ì¶”
  - í™”ë©´ì˜ í”Œë¡œìš°ì— ë”°ë¼ ì„œë¹„ìŠ¤ì˜ ì „ì²´ì  êµ¬ì¡°ë¥¼ ë³¼ ìˆ˜ ìˆì—ˆìŒ

<br>

### ìš”êµ¬ì‚¬í•­ ëª…ì„¸

- ì™€ì´ì–´í”„ë ˆì„ì„ ê¸°ë°˜ìœ¼ë¡œ í•„ìš”í•œ ê¸°ëŠ¥ê³¼ ë°ì´í„°ë¥¼ ëª…ì‹œ
  - ì—¬ëŸ¬ëª…ì´ ê°œë°œì„ í•˜ë‹¤ë³´ë©´ ê³µë°±ê³¼ ì¤‘ë³µì´ ë°œìƒí•  ê°€ëŠ¥ì„±
  - ìš”êµ¬ì‚¬í•­ ëª…ì„¸ì— ëª…ì‹œí•˜ì—¬ ì‘ì—… ë¶„ë°°ì— í™œìš©í•˜ê±°ë‚˜ í•„ìš”í•œ ë°ì´í„°ë¥¼ í™•ì¸

<br>

## **ğŸ§‘ğŸ¼â€ğŸ’»** RESTful API ì ìš©í•œ ìì› ëª…ì‹œ

![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2022-02-21 á„‹á…©á„’á…® 11.41.55](README.assets/rest.png)

![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2022-02-21 á„‹á…©á„’á…® 11.42.23](README.assets/rest2.png)

<br>

### RESTful APIì— ëŒ€í•œ ì˜¤ëœ ì‹œê°„ì˜ ê³ ë‡Œ

- ì²˜ìŒì— ê¸°ëŠ¥ë³„ë¡œ ê°œë°œí•œ ë’¤, RESTfulí•˜ê²Œ ë°”ê¾¸ë ¤ê³  í•˜ë‹ˆ ë§ì€ ìƒê°ê³¼ ê³ ë¯¼
  - ê¸°ëŠ¥ë³„ë¡œ ì´ë¯¸ ë‚˜ëˆ„ê³  ê°œë°œí•œ ìƒíƒœì—ì„œ ë¦¬íŒ©í† ë§
  - ìì›ì— ëŒ€í•œ ëª…ì‹œë¥¼ í•˜ë ¤ê³  í•˜ì˜€ìœ¼ë‚˜ ê¸°ëŠ¥ì´ ë¹ ì ¸ë²„ë¦¬ë©´ í˜¼ë€ì´ ë°œìƒ
  - ì¼ê´€ì„±ì„ ìœ ì§€í•˜ê¸° ìœ„í•´ ë…¸ë ¥



<br>

### RESTful APIë¡œì˜ ì ìš©

- [ê¸°ëŠ¥] / RESTful APIë¡œ ì ìš©
  - Backë‹¨ì—ì„œ ì‘ìš©í•˜ëŠ” APIì´ê¸° ë•Œë¬¸ì— ê¸°ëŠ¥ì„ ëª…ì‹œí•´ë„ ê´œì°®ê² ë‹¤ê³  í•©ì˜
  - ì£¼ë¡œ Collection, Document, Controller í™œìš© + GET, POST, DELETE ë“±
  - ëª…ì‚¬, ì†Œë¬¸ì, ì–¸ë”ë°”X/í•˜ì´í”ˆO, í–‰ìœ„X, ë§ˆì§€ë§‰ ìŠ¬ë˜ì‰¬X

<br>



## **ğŸ§›ğŸ¼â€â™‚ï¸** Docker, Jenkins, AWS(EC2)ë¥¼ í™œìš©í•œ CI/CD

#### ë„ì»¤ ì„¤ì¹˜ â‡’ Mysql ì´ë¯¸ì§€ â‡’ Jenkins ì´ë¯¸ì§€ â‡’ Jenkins ê¶Œí•œ ë¶€ì—¬ ë° ì„¤ì • â‡’ Jenkins-AWS Ubuntu ë°°í¬ ì—°ë™

![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2022-04-06 á„‹á…©á„’á…® 9.35.11.png](README.assets/100.png)

<br>

# **ğŸš£ğŸ»â€â™‚ï¸** Notion, Discordì„ í†µí•œ ë¹„ëŒ€ë©´ ì»¤ë®¤ë‹ˆì¼€ì´ì…˜

![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2022-02-21 á„‹á…©á„’á…® 11.23.09](README.assets/notion.png)

<br>

### Notionì˜ í™œìš©

![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2022-02-21 á„‹á…©á„’á…® 11.23.38](README.assets/notion2.png)

- í˜‘ì—…ì— ëŒ€í•œ ìë£Œë“¤ì˜ ì„¹ì…˜í™”
  - í”„ë¡œì íŠ¸ ìë£Œ, ì°¸ê³  ì‚¬ì´íŠ¸, ì—ëŸ¬ ë° ë²„ê·¸ í•´ê²° ë“± í”„ë¡œì íŠ¸ë¥¼ í•˜ë©´ì„œ ë§ì€ ìë£Œë“¤ì´ ë°œìƒ
  - ì´ ìë£Œë“¤ì„ ì„¹ì…˜í™”í•˜ê³  ì •ë¦¬í•  í•„ìš”ì„±ì— íŒ€ ë…¸ì…˜ ìš´ì˜

<br>

## Discordì˜ í™œìš©

![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2022-02-22 á„‹á…©á„Œá…¥á†« 1.06.26](README.assets/discord.png)

- ê³µí†µ/í”„ë¡ íŠ¸/ë°±ì—”ë“œ/ì§ˆë¬¸ë°© ì„¹ì…˜í™” í•˜ì—¬ ì‚¬ìš©

<br>

## **ğŸ‡ğŸ¼** ì†Œë‚˜íë¸Œ, local-ë°°í¬ì„œë²„ ì„¤ì • ë¶„ë¦¬, ë„¤ì´ë°ì»¨ë²¤ì…˜

![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2022-02-21 á„‹á…©á„’á…® 11.14.03](README.assets/sona.png)

![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2022-02-21 á„‹á…©á„’á…® 11.15.42.png](README.assets/sona2.png)



### ì†Œë‚˜íë¸Œ ì´ìš© í›„ ê°œì„ 

- ì†Œë‚˜íë¸Œë¡œ ì½”ë“œì˜ ë¬¸ì œë‚˜ ì‚¬ìš©í•˜ì§€ ì•Šì•„ì•¼í•˜ëŠ” ë¶€ë¶„ì„ ìë™ìœ¼ë¡œ íŒŒì•…

### local / ë°°í¬ì„œë²„ ì„¤ì • ë¶„ë¦¬

![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2022-02-23 á„‹á…©á„Œá…¥á†« 1.09.00.png](README.assets/convention.png)

- ApplicationContext.getEnvironment().getActiveProfiles()ì—ì„œ ì‹¤í–‰ì¤‘ì¸ í™˜ê²½ì„ íŒŒì•…



### ë„¤ì´ë° ì»¨ë²¤ì…˜

- í”„ë¡œì íŠ¸ ë‚´ ë³€ìˆ˜ëª…ê³¼ DBëª…, URLëª… í†µì¼
  - ì—¬ëŸ¬ëª…ì´ í•˜ë‹¤ë³´ë‹ˆ í†µì¼ë˜ì§€ ì•ŠëŠ” ë¶€ë¶„ ë°œìƒ
  - Java ì»¨ë²¤ì…˜ì— ë”°ë¼ ì¹´ë©œ ì¼€ì´ìŠ¤ë¡œ í”„ë¡œì íŠ¸ ë³€ìˆ˜ëª… í†µì¼
  - DB ì»¨ë²¤ì…˜ì— ë”°ë¼ ìŠ¤ë„¤ì´í¬ ì¼€ì´ìŠ¤ë¡œ DBëª… í†µì¼
  - RESTful API ì»¨ë²¤ì…˜ì— ë”°ë¼ urlëª… í†µì¼

<br>

## ğŸ¥ Feed ê´€ë ¨ ì½”ë“œ ìƒì„¸ ì„¤ëª…

>Spring Boot, JPA, Lombok

#### < Entity >

```java
@Entity                                                    // SpringBoot Entity
@Table(name = "feed")                                      // í…Œì´ë¸” ëª… ì§€ì •
@Data                                                      // @Getter @Setter @RequiredArgsConstructor...
@AllArgsConstructor                                        // ëª¨ë“  í•„ë“œ ê°’ì„ íŒŒë¼ë¯¸í„°ë¡œ ë°›ëŠ” ìƒì„±ì
@NoArgsConstructor                                         // íŒŒë¼ë¯¸í„°ê°€ ì—†ëŠ” ê¸°ë³¸ ìƒì„±ì
@Builder                                                   // ë¹Œë” ìƒì„± ê°€ëŠ¥í•˜ê²Œ
@ToString(callSuper = true)                                // ì‹œê°„ìë™ìƒì„± (1)
@EqualsAndHashCode(callSuper = true)                       // ì‹œê°„ìë™ìƒì„± (2)
public class Feed extends BaseTimeEntity {                 // ì‹œê°„ìë™ìƒì„± (3)

    @Id                                                    // pkì§€ì •
    @Column(name = "feed_id")                              // dbì˜ í…Œì´ë¸”ëª…
    @GeneratedValue(strategy = GenerationType.IDENTITY)    // ì‹œê°„ìë™ìƒì„± (1)
    private Long feedId;

    @Column(name = "title")
    private String title;

    @Column(name = "content")
    private String content;

    @Column(name = "media_url")                              // DBëª… : DB ìŠ¤ë„¤ì´í¬ ì¼€ì´ìŠ¤
    private String mediaUrl;                                 // ë³€ìˆ˜ëª… : Java ì¹´ë©œì¼€ì´ìŠ¤

    @Column(name = "like_cnt")
    private Long likeCnt;

    @ManyToMany
    @JoinTable(name = "feed_tag",                                // ìƒˆë¡œ ë§Œë“¤ì–´ì§ˆ í…Œì´ë¸”ì˜ ì´ë¦„
            joinColumns = @JoinColumn(name = "feed_id"),         // ìƒˆë¡œìš´ í…Œì´ë¸”ì˜ ì»¬ëŸ¼ëª… 1
            inverseJoinColumns = @JoinColumn(name = "tag_id"))   // ìƒˆë¡œìš´ í…Œì´ë¸”ì˜ ì»¬ëŸ¼ëª… 2
    private List<Tag> tags = new ArrayList<Tag>();

    @ManyToOne(fetch = FetchType.LAZY)   		                     // == 1:N ì£¼ì¸ / Lazy: ì§€ì—°ë¡œë”©, ì¡°íšŒí•  ë•Œ Proxy ì‚¬ìš©
    @JoinColumn(name = "user_id")
    private User user;

    @OneToMany(mappedBy = "feed")   		                         // ì§„ì§œëŠ” comments.feed
    @JsonIgnoreProperties({"feed"}) 		                         // ë¬´í•œì°¸ì¡° ë°©ì§€
    private List<Comment> comments = new ArrayList<>();

    @OneToMany(mappedBy = "feed")
    @JsonIgnoreProperties({"feed"})
    private List<Like> likes = new ArrayList<>();
}

```



#### < DTO >

```java
@Getter
@Setter
@Builder
@AllArgsConstructor
@NoArgsConstructor
public class FeedListDto {

    @ApiParam(value = "í”¼ë“œì•„ì´ë””")   		                         // Swaggerì— í‘œì‹œë˜ëŠ” ì´ë¦„
    private Long feedId;   		

    @ApiParam(value = "ìœ ì €ì´ë¦„")
    private String username;

    @ApiParam(value = "í”„ë¡œí•„ì‚¬ì§„")
    private String profileUrl;

    @ApiParam(value = "í”¼ë“œì‚¬ì§„")
    private String mediaUrl;

    @ApiParam(value = "ì¢‹ì•„ìš”ê°œìˆ˜")
    private Long likeCnt;

    @ApiParam(value = "í”¼ë“œë‚´ìš©")
    private String content;

    @ApiParam(value = "íƒœê·¸")
    private List<String> tags;

    @ApiParam(value = "ê²Œì‹œ ë‚ ì§œì‹œê°„")
    private LocalDateTime createdAt;

    @ApiParam(value = "ìˆ˜ì • ë‚ ì§œì‹œê°„")
    private LocalDateTime updatedAt;

    @ApiParam(value = "ì¢‹ì•„ìš” ì—¬ë¶€")
    private Boolean likeStatus;
}

```



#### < Repository >

```java
          		                          		                          	 // JpaRepo ìƒì†ë°›ì„ ë• @Repository ìƒëµ ê°€ëŠ¥ 
public interface FeedRepository extends JpaRepository<Feed, Long> {      // JpaRepository<Entity í´ë˜ìŠ¤, ID> ìƒì†

    List<Feed> findByUser(User user); 
}
```



#### < Controller >

```java
@Api("í”¼ë“œ ê´€ë ¨ ê¸°ëŠ¥ ì ‘ê·¼ ë°©ë²•")                                            // Swagger ì»¨íŠ¸ë¡¤ëŸ¬ ì œëª©
@RestController                                                       // ResponseBody ìƒëµ + Controller
@RequestMapping("/feed")                                              // ê³µí†µ URL
public class FeedController {

    private FeedService feedService;

    @Autowired                                                        // ìƒì„±ì ì£¼ì…
    public FeedController(FeedService feedService) {
        this.feedService = feedService;
    }


    //=========================Feed=========================//

    @ApiOperation(value = "í”¼ë“œ ë“±ë¡", notes = "í”¼ë“œ ë“±ë¡")            // Swagger - value: url ì˜†ì—, notes: ì—´ë©´ ìƒë‹¨ì—
    @ApiResponses({                                               // Swagger - Response ì½”ë“œì— ëŒ€í•œ ë©”ì„¸ì§€
            @ApiResponse(code = 200, message = "í”¼ë“œ ìƒì„±ì— ì„±ê³µí•˜ì˜€ìŠµë‹ˆë‹¤."),
            @ApiResponse(code = 400, message = "ì˜ëª»ëœ ìš”ì²­ì…ë‹ˆë‹¤. ê³„ì •ì„ ëª…ì‹œí•˜ì§€ ì•Šì•˜ê±°ë‚˜ ë¡œê·¸ì¸ ì •ë³´ì™€ ë§ì§€ ì•ŠìŠµë‹ˆë‹¤. ë˜ëŠ” ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ë¯¸ë””ì–´ íŒŒì¼ì…ë‹ˆë‹¤."),
            @ApiResponse(code = 500, message = "ì„œë²„ ì—ëŸ¬ì…ë‹ˆë‹¤.")
    })
    @PostMapping("/feeds") // ResponseEntity<>(message, headers, HttpStatus.OK) ==> ResponseEntity.ok(message)
    public ResponseEntity<?> postFeed(@ModelAttribute("file") FeedDto feedDto, TagDto tagDto){
        return feedService.postFeed(feedDto,tagDto);
    }

    @ApiOperation(value = "í”¼ë“œ ì „ì²´ ì¡°íšŒ", notes = "ì „ì²´ í”¼ë“œë¥¼ ì¡°íšŒí•©ë‹ˆë‹¤.")
    @ApiResponses({
            @ApiResponse(code = 200, message = "í”¼ë“œ ì¡°íšŒì— ì„±ê³µí•˜ì˜€ìŠµë‹ˆë‹¤."),
            @ApiResponse(code = 500, message = "ì„œë²„ì—ëŸ¬ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.")
    })
	  // RestAPI : ìì›ì— ëŒ€í•œ ëª…ì‹œ + GET,POST,PUT,DELETE / Document, Collection, Store, Controller
    @GetMapping("/feeds") 
    public List<FeedDto> getAllFeeds() {
        return feedService.getAllFeeds();
    }

    @ApiOperation(value = "íŒ”ë¡œìš°ê¸°ë°˜ í”¼ë“œ ì¡°íšŒ(ë©”ì¸)", notes = "ë¡œê·¸ì¸ í•œ ì‚¬ìš©ìê°€ íŒ”ë¡œìš° í•˜ëŠ” ìœ ì €ì˜ í”¼ë“œë¥¼ ì¡°íšŒí•˜ì—¬ ëª©ë¡ìœ¼ë¡œ ë³´ì—¬ì¤ë‹ˆë‹¤.")
    @ApiResponses({
            @ApiResponse(code = 200, message = "íŒ”ë¡œìš° í•˜ëŠ” í”¼ë“œ ì¡°íšŒì— ì„±ê³µí•˜ì˜€ìŠµë‹ˆë‹¤."),
            @ApiResponse(code = 500, message = "ì„œë²„ì—ëŸ¬ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.")
    })
    @GetMapping("/feeds/follower")
    public List<FeedListDto> getFollowerFeeds() {
        return feedService.getFollowerFeeds();
    }

    @ApiOperation(value = "ìœ ì € í”¼ë“œ ì¡°íšŒ(1)", notes = "ë‚´ê°€ ì‘ì„±í•œ í”¼ë“œë¥¼ ì¡°íšŒí•©ë‹ˆë‹¤.")
    @ApiResponses({
            @ApiResponse(code = 200, message = "ìš”ì²­í•œ ì‚¬ìš©ìì˜ í”¼ë“œ ì¡°íšŒì— ì„±ê³µí•˜ì˜€ìŠµë‹ˆë‹¤."),
            @ApiResponse(code = 500, message = "ì„œë²„ì—ëŸ¬ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.")
    })
    @GetMapping("/feeds/profiles/{email}") // Get : PathVariable (O), RequestBody (X)
    public ResponseEntity<List<FeedDto>> getProfileFeeds(@PathVariable String email) {   // ë³€ìˆ˜ëª… ê°™ì„ ë•ŒëŠ” ìƒëµ ê°€ëŠ¥
        return ResponseEntity.ok(feedService.getProfileFeeds(email));
    }

    @ApiOperation(value = "í”¼ë“œ ê°œë³„ ì¡°íšŒ", notes = "ê°œë³„ í”¼ë“œë¥¼ ì¡°íšŒí•©ë‹ˆë‹¤.")
    @ApiResponses({
            @ApiResponse(code = 200, message = "í”¼ë“œ ì¡°íšŒì— ì„±ê³µí•˜ì˜€ìŠµë‹ˆë‹¤."),
            @ApiResponse(code = 500, message = "ì„œë²„ì—ëŸ¬ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.")
    })
    @GetMapping("/feeds/{feed_id}")
    public FeedListDto getFeed(@PathVariable("feed_id") Long feedId) { // ë³€ìˆ˜ëª… ë‹¤ë¥¼ ë•ŒëŠ” ì§€ì •
        return feedService.getFeed(feedId);
    }

    @ApiOperation(value = "í”¼ë“œë¦¬ìŠ¤íŠ¸ ì¡°íšŒ(ê²€ìƒ‰)", notes = "ì „ì²´ í”¼ë“œë¦¬ìŠ¤íŠ¸(ê²€ìƒ‰)")
    @ApiResponses({
            @ApiResponse(code = 200, message = "í”¼ë“œë¦¬ìŠ¤íŠ¸ ì¡°íšŒ ì„±ê³µ"),
            @ApiResponse(code = 500, message = "ì„œë²„ ì—ëŸ¬ì…ë‹ˆë‹¤.")
    })
    @GetMapping("/feeds/search")
    public ResponseEntity<List<FeedListDto>> getSearchFeeds() {
        return ResponseEntity.ok(feedService.getSearchFeeds());
    }

    @ApiOperation(value = "ìœ ì € í”¼ë“œ ì¡°íšŒ(2)", notes = "ìœ ì €ê°€ ì‘ì„±í•œ í”¼ë“œ ë¦¬ìŠ¤íŠ¸(í”„ë¡œí•„)")
    @ApiResponses({
            @ApiResponse(code = 200, message = "ìœ ì €ê°€ ì‘ì„±í•œ í”¼ë“œ ë¦¬ìŠ¤íŠ¸ ì¡°íšŒ ì„±ê³µ"),
            @ApiResponse(code = 500, message = "ì„œë²„ ì—ëŸ¬ì…ë‹ˆë‹¤.")
    })
    @GetMapping("/feeds/profiles/{email}/temp")
    public ResponseEntity<List<FeedProfileDto>> getProfileFeeds_temp(@PathVariable String email) {
        return ResponseEntity.ok(feedService.getProfileFeeds_temp(email));
    }

    @ApiOperation(value = "í”¼ë“œ ìˆ˜ì •(ì¡°íšŒ)", notes = "í”¼ë“œ ìˆ˜ì •(ì¡°íšŒ)")
    @ApiResponses({
            @ApiResponse(code = 200, message = "í”¼ë“œ ìˆ˜ì •ì— ì„±ê³µí•˜ì˜€ìŠµë‹ˆë‹¤."),
            @ApiResponse(code = 500, message = "ì„œë²„ ì—ëŸ¬ì…ë‹ˆë‹¤.")
    })
    @GetMapping("/feeds/{feed_id}/temp")
    public ResponseEntity<?> getUpdateFeedInfo(@PathVariable Long feed_id){
        return ResponseEntity.ok(feedService.getUpdateFeedInfo(feed_id));
    }

    @ApiOperation(value = "í”¼ë“œ ìˆ˜ì •(ì‹¤í–‰)", notes = "í”¼ë“œ ìˆ˜ì •(ì‹¤í–‰)")
    @ApiResponses({
            @ApiResponse(code = 200, message = "í”¼ë“œ ìˆ˜ì •ì— ì„±ê³µí•˜ì˜€ìŠµë‹ˆë‹¤."),
            @ApiResponse(code = 500, message = "ì„œë²„ ì—ëŸ¬ì…ë‹ˆë‹¤.")
    })
    @PutMapping("/feeds/{feed_id}")
    public ResponseEntity<?> updateFeed(@PathVariable("feed_id") Long feedId, @RequestBody FeedDto feedDto){
        return feedService.updateFeed(feedId,feedDto);
    }

    @ApiOperation(value = "í”¼ë“œ ì‚­ì œ", notes = "ìš”ì²­í•œ í”¼ë“œë¥¼ ì‚­ì œí•©ë‹ˆë‹¤.")
    @ApiResponses({
            @ApiResponse(code = 200, message = "í”¼ë“œ ì‚­ì œì— ì„±ê³µí•˜ì˜€ìŠµë‹ˆë‹¤."),
            @ApiResponse(code = 400, message = "ìš”ì²­í•œ í”¼ë“œê°€ ì—†ìŠµë‹ˆë‹¤."),
            @ApiResponse(code = 500, message = "ì„œë²„ì—ëŸ¬ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.")
    })
    @DeleteMapping("/feeds/{feed_id}")
    public ResponseEntity<?> deleteFeed(@PathVariable("feed_id") Long feed_id){
        return feedService.deleteFeed(feed_id);
    }

    //=========================Comment=========================//

    @ApiOperation(value = "í”¼ë“œ ëŒ“ê¸€ ì‘ì„±", notes = "í”¼ë“œì— ëŒ“ê¸€ì„ ì‘ì„±í•˜ì—¬ ì¶”ê°€í•©ë‹ˆë‹¤.")
    @ApiResponses({
            @ApiResponse(code = 200, message = "ìš”ì²­í•œ í”¼ë“œì— ì„±ê³µì ìœ¼ë¡œ ëŒ“ê¸€ì„ ì‘ì„±í•˜ì˜€ìŠµë‹ˆë‹¤."),
            @ApiResponse(code = 500, message = "ì„œë²„ì—ëŸ¬ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.")
    })
    @PostMapping("/{feed_id}/comments")    // Post ìš”ì²­ - RequestBody + DTOë¥¼ í†µí•œ ì…/ì¶œë ¥
    public ResponseEntity<?> postComment(@PathVariable("feed_id") Long feed_id, @RequestBody CommentDto commentDto) {
        return feedService.postComment(feed_id, commentDto);
    }

    @ApiOperation(value = "í”¼ë“œ ëŒ“ê¸€ ì¡°íšŒ", notes = "í”¼ë“œì— ë“±ë¡ëœ ëŒ“ê¸€ì„ ì¡°íšŒí•©ë‹ˆë‹¤.")
    @ApiResponses({
            @ApiResponse(code = 200, message = "ìš”ì²­í•œ í”¼ë“œì˜ ëŒ“ê¸€ ì¡°íšŒì— ì„±ê³µí•˜ì˜€ìŠµë‹ˆë‹¤."),
            @ApiResponse(code = 500, message = "ì„œë²„ì—ëŸ¬ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.")
    })
    @GetMapping("/{feed_id}/comments")
    public ResponseEntity<List<CommentListDto>> getComments(@PathVariable Long feed_id) {
        return ResponseEntity.ok(feedService.getComments(feed_id));
    }

    @ApiOperation(value = "í”¼ë“œ ëŒ“ê¸€ ì‚­ì œ", notes = "í”¼ë“œì— ì‘ì„±í•œ ëŒ“ê¸€ì„ ì‚­ì œí•©ë‹ˆë‹¤.")
    @ApiResponses({
            @ApiResponse(code = 200, message = "ìš”ì²­í•œ ëŒ“ê¸€ì˜ ì‚­ì œì— ì„±ê³µí•˜ì˜€ìŠµë‹ˆë‹¤."),
            @ApiResponse(code = 500, message = "ì„œë²„ì—ëŸ¬ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.")
    })
    @DeleteMapping("/{feed_id}/comments/{comment_id}")  // RestAPI : document + collection + document (delete)
    public ResponseEntity<?> deleteComment(@PathVariable("comment_id") Long comment_id) {
        return feedService.deleteComment(comment_id);
    }
}
```



----



### <Sub : ë¯¸ë””ì–´íŒŒì¼ ì—…ë¡œë“œ>

#### Controller

```java
@PostMapping("/feeds")
public ResponseEntity<?> postFeed(@ModelAttribute FeedDto feedDto, TagDto tagDto){
  return feedService.postFeed(feedDto,tagDto);
}
```

* @RequestMapping í•˜ìœ„ ì–´ë…¸í…Œì´ì…˜, @ModelAttribute



#### DTO

```java
...
 @ApiParam(value = "í”¼ë“œ ì²¨ë¶€íŒŒì¼")
    private MultipartFile media;
...
```

* MultipartFile ì†ì„±ì˜ ê°ì²´ë¥¼ ë°›ìŒ



#### postFeed(Service)

```java
@Transactional                                                                // ì‘ì—…ì´ ì™„ë£Œë˜ì§€ ì•Šìœ¼ë©´ ë¦¬ì…‹
public ResponseEntity<?> postFeed(FeedDto feedDto, TagDto tagDto){

  MultipartFile multipartFile = feedDto.getMedia();

                                                                              // ë¯¸ë””ì–´íŒŒì¼ í•„ìˆ˜ : ì—†ìœ¼ë©´ return
  if(multipartFile == null || multipartFile.isEmpty()){
    return new ResponseEntity<>(HttpStatus.BAD_REQUEST);
  }

                                                                              // í˜„ì¬ ë‚ ì§œ í´ë”ë§Œë“¤ì–´ì„œ ì €ì¥
  String currentDate = new SimpleDateFormat("yyyyMMdd").format(Calendar.getInstance().getTime());
  String uploadFilePath = config.getUploadFilePath()+currentDate+"/";  // globalConfigì—ì„œ ì•Œë§ëŠ” ì‹¤ì œ ì €ì¥ ê²½ë¡œ ë°˜í™˜

  // ëœë¤ì´ë¦„ + . í™•ì¥ì ê°€ì ¸ì˜¤ê¸°
  String postfix = multipartFile.getOriginalFilename().substring(multipartFile.getOriginalFilename().lastIndexOf(".")+1, multipartFile.getOriginalFilename().length());                         // í™•ì¥ì ë”°ê¸°
  String filename = UUID.randomUUID().toString() + "." + postfix;      // UUID ìƒì„±í›„ í™•ì¥ì ë¶™ì´ê¸°

  // í´ë” ì—†ìœ¼ë©´ ë§Œë“¤ê¸°
  File folder = new File(uploadFilePath);                              // ì‹¤ì œ ê²½ë¡œ íŒŒì¼ ë§Œë“¤ê¸°
  if(!folder.isDirectory()){                                           // ê·¸ê²Œ ë””ë ‰í† ë¦¬ê°€ ì•„ë‹ˆë©´
    folder.mkdirs();                                                   // ê²½ë¡œê°€ ì§€ì •ëœ í´ë” ë§Œë“¤ê¸°
  }

  String pathname = uploadFilePath+filename;                           // ì‹¤ì œ ê²½ë¡œ + íŒŒì¼ ì´ë¦„
  String resourcePathname = config.getUploadResourcePath()+currentDate+"/"+filename; // ë³´ì—¬ì¤„ ê²½ë¡œ + íŒŒì¼

  // url ê²½ë¡œ ì¶œë ¥
  System.out.println("resourcePathname = " + resourcePathname);      

  // ìƒˆë¡œ íŒŒì¼ ë§Œë“¤ê¸°
  File dest = new File(pathname);                                      // ì‹¤ì œê²½ë¡œ+íŒŒì¼ì´ë¦„ ìœ¼ë¡œ ëœ íŒŒì¼ ë§Œë“¤ê¸°
  try {
    multipartFile.transferTo(dest);                                    // ì…ë ¥ëœ íŒŒì¼ë¡œ ë°”ê¿”ì¹˜ê¸° 
  } catch (IOException e) {
    e.printStackTrace();
  }

  // Get User
  PrincipalDetails principalDetails = (PrincipalDetails) SecurityContextHolder.getContext().getAuthentication().getPrincipal();   // ì¸ì¦ì •ë³´ì— principal ì£¼ì²´ ê°€ì ¸ì˜¤ê¸°
  User userTemp = principalDetails.getUser();  // principalì— ì €ì¥ëœ ìœ ì € ì •ë³´ ê°€ì ¸ì˜¤ê¸°
  User user = userRepository.findByEmail(userTemp.getEmail());//ê·¸ëƒ¥ìœ ì €ë‘ì€ ë‹¤ë¥´ë‹ˆ userTempì´ë©”ì¼ë¡œ ì œëŒ€ë¡œëœ ìœ ì € ê°ì²´ ì°¾ê¸°

  // Tag
  List<Tag> resTags = new ArrayList<>();                                // íƒœê·¸ ë‹´ì•„ë‘˜ ë¦¬ìŠ¤íŠ¸

  for (String tempName : tagDto.getTagList()) {                         // ë“¤ì–´ì˜¨ íƒœê·¸ ëŒë©´ì„œ
    Tag tempTag = tagRepository.findByName(tempName);                   // í•´ë‹¹ ì´ë¦„ìœ¼ë¡œ íƒœê·¸ ì°¾ê¸°
    if (tempTag != null) {                                              // ì´ë¯¸ ìˆìœ¼ë©´
      resTags.add(tempTag);                                             // íƒœê·¸ë¦¬ìŠ¤íŠ¸ì— ìˆëŠ” ê²ƒ ì¶”ê°€
    } else {
      Tag newTag = Tag.builder()                                        // ì—†ìœ¼ë©´ ë§Œë“¤ê¸°
        .name(tempName)
        .build();
      tagRepository.save(newTag);                                       
      resTags.add(newTag);                            
    }
  }

  // Create Feed
  Feed feed = Feed.builder()
    .title(feedDto.getTitle())
    .content(feedDto.getContent())
    .likeCnt(0L)
    .mediaUrl(resourcePathname)                                          // ë³´ì—¬ì¤„ ê²½ë¡œë§Œ ì €ì¥
    .user(user)
    .tags(resTags)         // many to manyì´ê¸° ë•Œë¬¸ì— ê·¸ëƒ¥ ë¦¬ìŠ¤íŠ¸ë¡œ ì €ì¥í•˜ë©´ ì•Œì•„ì„œ tag-feed í…Œì´ë¸”ì— ì €ì¥(feedê°€ keyì˜ ì£¼ì¸ì„)
    .build();

  feedRepository.save(feed);
  return new ResponseEntity<>(HttpStatus.OK);
}
```



#### GlobalConfig

```java
@Configuration
public class GlobalConfig {

    private final ApplicationContext context;                                     // ì‹¤í–‰ë˜ê³  ìˆëŠ” í™˜ê²½ íŒŒì•…
    private final ResourceLoader resourceLoader;                                  // resourceì— ìˆëŠ” íŒŒì¼ ê°€ì ¸ì˜¤ê¸°

    @Autowired
    public GlobalConfig(ApplicationContext context, ResourceLoader resourceLoader) {
        this.context = context;
        this.resourceLoader = resourceLoader;
    }

    private String uploadPath;                                                    // ì‹¤ì œ ì €ì¥ ê²½ë¡œ
    private String resourcePath;                                                  // ë³´ì—¬ì£¼ê¸° ê²½ë¡œ

    @PostConstruct                                                          // ë¹ˆ ìƒì„± í›„, ì„œë¹„ìŠ¤ ë“¤ì–´ê°€ê¸° ì „ 1ë²ˆë§Œ ì‹¤í–‰
    public void init(){
        String[] activeProfiles = context.getEnvironment().getActiveProfiles(); //ë°°í¬ì¤‘ì´ë¼ë©´,activeProfiles=[dep]
        String activeProfile = "local";                                     // ê¸°ë³¸ í”„ë¡œí•„ì€ localë¡œ ì„¤ì •
        if(!ObjectUtils.isEmpty(activeProfiles)){                           // ë°°í¬ ì¤‘ì´ë¼ë©´
            activeProfile = activeProfiles[0];                              // "dep"ìœ¼ë¡œ ì„¤ì •
        }
        String resourcePath = String.format("classpath:globals/global-%s.properties",activeProfile); //ì„¤ì •íŒŒì¼ê²½ë¡œ
        try{
            Resource resource = resourceLoader.getResource(resourcePath);   // ì„¤ì •ê²½ë¡œë¡œ ìì› ì„¤ì •
            Properties properties = PropertiesLoaderUtils.loadProperties(resource); // ì„¤ì •íŒŒì¼ ê°’ ê°€ì ¸ì˜¤ê¸°

            this.uploadPath = properties.getProperty("uploadFile.path"); // ì‹¤ì œ ì €ì¥ ê²½ë¡œ ì„¤ì •=uploadPath
            this.resourcePath = properties.getProperty("uploadFile.resourcePath"); // ë³´ì—¬ì£¼ê¸° ê²½ë¡œì„¤ì •=resourcePath
        }catch (Exception e){
            System.out.println("e = " + e);
        }
    }
                                                                                  // Getter
    public String getUploadPath() {
        return uploadPath;
    }

    public String getResourcePath() {
        return resourcePath;
    }

    public String getUploadFilePath() {
        return uploadPath;
    }

    public String getUploadResourcePath() {
        return resourcePath;
    }
}
```



#### global-dep.properties / global-local.properties

```properties
# global-dep.properties                                                  // ë°°í¬ì„œë²„ ì„¤ì •
uploadFile.path= /home/resources/                                        // ì‹¤ì œ ì €ì¥ ê²½ë¡œ ì„¤ì •
uploadFile.resourcePath= /upload/                                        // ë³¼ ìˆ˜ ìˆëŠ” url ì„¤ì •

# global-local.properties                                                // ë¡œì»¬ì„œë²„ ì„¤ì •
uploadFile.path= C:/                                                     // ì‹¤ì œ ì €ì¥ ê²½ë¡œ ì„¤ì •
uploadFile.resourcePath= /upload/                                        // ë³¼ ìˆ˜ ìˆëŠ” url ì„¤ì •
```



----



#### < ì¡°íšŒ >

> ë§ì€ ì¡°íšŒê°€ ìˆì§€ë§Œ ê¸°ë³¸ ì ì¸ íë¦„ì€ ë¹„ìŠ·í•˜ì—¬, íŒ”ë¡œìš° ê¸°ë°˜ ì¡°íšŒ ë° ëŒ“ê¸€ ì¡°íšŒë¥¼ ëŒ€í‘œë¡œ í•¨

##### íŒ”ë¡œìš° ê¸°ë°˜ ì¡°íšŒ

```java
public List<FeedListDto> getFollowerFeeds() {  

  // Get User
  PrincipalDetails principalDetails = (PrincipalDetails) SecurityContextHolder.getContext().getAuthentication().getPrincipal();
  User userTemp = principalDetails.getUser();
  User user = userRepository.findByEmail(userTemp.getEmail());

  // Return Feed List
  List<FeedListDto> result = new ArrayList<>();

  // Get Followings by User
  List<Follow> followings = followRepository.findByFollower(user);//íŒ”ë¡œìš°repoë¥¼ í†µí•´ userê°€ íŒ”ë¡œì›Œì¸ followê´€ê³„ ê°€ì ¸ì˜¤ê¸°

  // Add Following's Feed
  for (Follow following : followings) {                           // íŒ”ë¡œìš° ê´€ê³„ ìˆœíšŒí•˜ë©´ì„œ

    User toUser = following.getFollowing();                       // íŒ”ë¡œì‰ í•˜ëŠ” ì‚¬ëŒ ê°€ì ¸ì˜¤ê¸°
    List<Feed> feeds = toUser.getFeeds();                         // ê·¸ì‚¬ëŒì˜ í”¼ë“œë“¤ ê°€ì ¸ì˜¤ê¸°

    for (Feed feed : feeds) {                                     // í”¼ë“œ ëŒë©´ì„œ
      FeedListDto feedListDto = new FeedListDto();                // Dtoì— ë‹´ì•„ì£¼ê³ 

      feedListDto.setFeedId(feed.getFeedId());                   
      feedListDto.setUsername(feed.getUser().getUsername());
      feedListDto.setProfileUrl(feed.getUser().getImagePath());
      feedListDto.setMediaUrl(feed.getMediaUrl());
      feedListDto.setLikeCnt(feed.getLikeCnt());
      feedListDto.setContent(feed.getContent());
      feedListDto.setEmail(feed.getUser().getEmail());

      List<String> tempTags = new ArrayList<>();//íƒœê·¸ëŠ” Tagí´ë˜ìŠ¤ê°€ ì•„ë‹Œ Stringí˜•íƒœë¡œ ë‹´ì•„ì¤˜ì•¼í•˜ê¸°ë•Œë¬¸ì— Nameë“¤ë§Œ ë”°ì„œ ë‹´ì•„ì¤Œ
      for (Tag tag : feed.getTags()) {
        tempTags.add(tag.getName());
      };
      feedListDto.setTags(tempTags);

      feedListDto.setCreatedAt(feed.getCreatedAt());
      feedListDto.setUpdatedAt(feed.getUpdatedAt());

      // Check like_status
      Like like_flag = likeRepository.findByUserAndFeed(user, feed);    //likeRepoì— likeê´€ê³„ í™•ì¸í›„ ì²´í¬í•˜ê³  ë‹´ê¸°
      if (like_flag != null) {
        feedListDto.setLikeStatus(true);
      } else {
        feedListDto.setLikeStatus(false);
      }

      result.add(feedListDto);
    }
  }

  // Add My Feed
  List<Feed> feeds = feedRepository.findByUser(user);               // ë¡œê·¸ì¸í•œ ìœ ì €ì˜ í”¼ë“œë„ í•„ìš”
  for (Feed feed : feeds) {
    FeedListDto feedListDto = new FeedListDto();

    feedListDto.setFeedId(feed.getFeedId());
    feedListDto.setUsername(feed.getUser().getUsername());
    feedListDto.setProfileUrl(feed.getUser().getImagePath());
    feedListDto.setMediaUrl(feed.getMediaUrl());
    feedListDto.setLikeCnt(feed.getLikeCnt());
    feedListDto.setContent(feed.getContent());
    feedListDto.setEmail(feed.getUser().getEmail());

    List<String> tempTags = new ArrayList<>();
    for (Tag tag : feed.getTags()) {
      tempTags.add(tag.getName());
    };
    feedListDto.setTags(tempTags);

    feedListDto.setCreatedAt(feed.getCreatedAt());
    feedListDto.setUpdatedAt(feed.getUpdatedAt());

    // Check like_status
    Like like_flag = likeRepository.findByUserAndFeed(user, feed);
    if (like_flag != null) {
      feedListDto.setLikeStatus(true);
    } else {
      feedListDto.setLikeStatus(false);
    }

    result.add(feedListDto);
  }

  // Sorting By Created time
  result.sort(new Comparator<FeedListDto>() {
    @Override
    public int compare(FeedListDto o1, FeedListDto o2) {
      return o2.getFeedId().intValue() - o1.getFeedId().intValue();   // pkê°’ì„ í†µí•´ ì •ë ¬, Longê°’ì´ë¼ intë¡œ ë³€í™˜ í›„ ê³„ì‚°
    }
  });

  return result;
}
```



##### ëŒ“ê¸€ ì¡°íšŒ

```java
public List<CommentListDto> getComments(Long feed_id) {

  // Get Feed
  Optional<Feed> feed = feedRepository.findById(feed_id);
  if (!feed.isPresent()) {
    return null;
  }
  List<CommentListDto> result = new ArrayList<>();

  for (Comment comment : commentRepository.findByFeed(feed.get())) {   //ëŒ“ê¸€Repoì—ì„œ feedë¡œ ëŒ“ê¸€ë“¤ ì°¾ê³  ìˆœíšŒ
    CommentListDto commentListDto = new CommentListDto();

    commentListDto.setCommentId(comment.getCommentId());
    commentListDto.setProfileUrl(comment.getUser().getImagePath());
    commentListDto.setEmail(comment.getUser().getEmail());
    commentListDto.setUsername(comment.getUser().getUsername());
    commentListDto.setContent(comment.getContent());
    commentListDto.setCreatedAt(comment.getCreatedAt());

    result.add(commentListDto);
  }

  return result;                                                        // ëŒ“ê¸€ë“¤ Dtoì— ë„£ì–´ ë°˜í™˜
}
```





#### < ìˆ˜ì • >

> ëŒ€í‘œë¡œ í”¼ë“œ ìˆ˜ì •

##### í”¼ë“œ ìˆ˜ì •

```java
@Transactional                                                 // ëª¨ë“  ì‘ì—…ì´ ì„±ê³µí•˜ì§€ ì•Šìœ¼ë©´ ëª¨ë“  ë¡œì§ì„ ì²˜ë¦¬ í•˜ì§€ ì•ŠìŒ
public ResponseEntity<?> updateFeed(Long feedId, FeedDto feedDto) {     

  // Get Feed
  Optional<Feed> optFeed = feedRepository.findById(feedId);    
  if (!optFeed.isPresent()) {
    return new ResponseEntity<>(HttpStatus.BAD_REQUEST);
  }
  Feed feed = optFeed.get();          

  List<Tag> resTags = new ArrayList<>();

  for (String tempName : feedDto.getTags()) {                  
    Tag tempTag = tagRepository.findByName(tempName);          
    if (tempTag != null) {
      resTags.add(tempTag);
    } else {
      Tag newTag = Tag.builder()
        .name(tempName)
        .build();
      tagRepository.save(newTag);
      resTags.add(newTag);
    }
  }

  // Update Feed
  feed.setTitle(feedDto.getTitle());
  feed.setContent(feedDto.getContent());
  feed.setTags(resTags);                                   // keyì˜ ì£¼ì¸ì´ë¼ ë°”ë¡œ ë„£ì–´ì£¼ë©´ ê´€ê³„ë§¤í•‘ ì•Œì•„ì„œ ë¨
  feedRepository.save(feed);

  return new ResponseEntity<>(HttpStatus.OK);
}
```



#### < ì‚­ì œ >

##### í”¼ë“œ ì‚­ì œ

```java
@Transactional
    public ResponseEntity<?> deleteFeed(Long feed_id) {

        // Get Feed
        Optional<Feed> feed = feedRepository.findById(feed_id);
        if (!feed.isPresent()) {
            return new ResponseEntity<>(HttpStatus.BAD_REQUEST);
        }
        // Check Existence
        if (!feed.isPresent()) {
            return new ResponseEntity<>(HttpStatus.BAD_REQUEST);
        } else {
            feedRepository.delete(feed.get());                            // JPA í”¼ë“œRepo deleteë©”ì„œë“œ í™œìš© ì‚­ì œ
            return new ResponseEntity<>(HttpStatus.OK);
        }
    }
```



## Tag

#### < Entity >

```java
@Entity
@Table(name = "tag")
@Data
@AllArgsConstructor
@NoArgsConstructor
@Builder
public class Tag {
    @Id
    @Column(name = "tag_id")
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    private Long tagId;

    @Column(name = "name")
    private String name;

    @Builder.Default//@BuilderëŠ” ê¸°ë³¸ì ìœ¼ë¡œ ìƒì„±ë˜ìˆëŠ”ê²ƒì„ ë°›ì§€ì•ŠëŠ”ë° í˜„ì¬ë¦¬ìŠ¤íŠ¸ë¡œì´ˆê¸°í™”í•´ì£¼ëŠ”ì¤‘,ë”°ë¼ì„œì´ê±°ë¬´ì‹œí•˜ë¼ê³ @Builder.Default
    @ManyToMany(mappedBy = "tags",cascade = CascadeType.ALL)  // í‚¤ì˜ ì£¼ì¸ì€ feeds, feedê°€ì‚¬ë¼ì§ˆë•Œê°™ì´ì‚¬ë¼ì§€ë„ë¡ Cascade
    private List<Feed> feeds = new ArrayList<>();   // ManytoManyë¼ì„œ ì´ˆê¸° ê°’ì€ ë¹ˆ ë¦¬ìŠ¤íŠ¸ë¡œ ì„¤ì •
}
```



#### < DTO >

```java
@Getter
@Setter
@Builder
@AllArgsConstructor
@NoArgsConstructor
public class TagDto {

    @ApiParam(value = "íƒœê·¸ ì´ë¦„")
    private List<String> tagList;       // String ê°’ìœ¼ë¡œ ì™”ë‹¤ê°”ë‹¤ í•  ìˆ˜ ìˆì–´ì•¼ í•˜ê³ , ì—¬ëŸ¬ê°œë¥¼ ë™ì‹œì— ë°›ì„ ìˆ˜ ìˆì–´ List<String>
}
```



#### < Repository >

```java
public interface TagRepository extends JpaRepository<Tag, Integer> {
    Tag findByName(String name);         // ì´ë¦„ìœ¼ë¡œ ì°¾ê¸°
}
```



## Like

#### < Entity >

```java
@Entity
@Table(name = "`like`")
@Builder
@Data
@AllArgsConstructor
@NoArgsConstructor
public class Like {
    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    @Column(name = "like_id")
    private Long likeId;

    @ManyToOne                                 // ì—¬ëŸ¬ê°œì˜ ìœ ì €ê°€ ìˆì„ ìˆ˜ ìˆê³ 
    @JoinColumn(name = "user_id")
    private User user;

    @ManyToOne                                 // ì—¬ëŸ¬ê°œì˜ í”¼ë“œê°€ ìˆì„ ìˆ˜ ìˆê³  ìˆë‹¤.
    @JoinColumn(name = "feed_id")
    private Feed feed;
}
```



#### < Repository > 

```java
public interface LikeRepository extends JpaRepository<Like, Long> {

    Like findByUserAndFeed(User user, Feed feed);                 // user, feed ë‘ê°œì˜ ë§¤í•‘ìœ¼ë¡œ Likeê´€ê³„ ì°¾ê¸° ê°€ëŠ¥
    List<Like> findAllByFeed(Feed feed);
}
```



#### < Controller > 

```java
@Api("'ì¢‹ì•„ìš”' ê¸°ëŠ¥ ì ‘ê·¼ ë°©ë²•")
@RestController
@RequestMapping("/feed")                                      // í”¼ë“œ ê¸°ëŠ¥ ì†ì— like
public class LikeController {

    private LikeService likeService;

    @Autowired
    public LikeController(LikeService likeService) {
        this.likeService = likeService;
    }

    //=========================Like=========================//

    @ApiOperation(value = "ì¢‹ì•„ìš” ì¶”ê°€", notes = "ì¢‹ì•„ìš” ì¶”ê°€")
    @ApiResponses({
            @ApiResponse(code = 200, message = "í”¼ë“œë¥¼ ì„±ê³µì ìœ¼ë¡œ ì¡°íšŒí–ˆìŠµë‹ˆë‹¤."),
            @ApiResponse(code = 400, message = "ì´ë¯¸ ì¢‹ì•„ìš” ìƒíƒœì…ë‹ˆë‹¤."),
            @ApiResponse(code = 500, message = "ì„œë²„ì—ëŸ¬ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.")
    })
    @PostMapping({"/{feed_id}/likes"})                         // REST: Document + Collection [POST]
    public ResponseEntity likeFeed(@PathVariable Long feed_id) {
        return likeService.likeFeed(feed_id);
    }

    @ApiOperation(value = "ì¢‹ì•„ìš”í•œ ì‚¬ëŒë“¤ ì¡°íšŒ", notes = "ì¢‹ì•„ìš”í•œ ì‚¬ëŒë“¤ ì¡°íšŒ")
    @ApiResponses({
            @ApiResponse(code = 200, message = "ì¡°íšŒë¥¼ ì„±ê³µì ìœ¼ë¡œ ì‹¤í–‰í–ˆìŠµë‹ˆë‹¤."),
            @ApiResponse(code = 500, message = "ì„œë²„ì—ëŸ¬ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.")
    })
    @GetMapping({"/{feed_id}/likes"})                         // REST: Document + Collection [GET]
    public ResponseEntity<List<LikeUserDto>> getLikeUsers(@PathVariable Long feed_id) {
        return ResponseEntity.ok(likeService.getLikeUsers(feed_id));
    }

    @ApiOperation(value = "ì¢‹ì•„ìš” ì·¨ì†Œ", notes = "ì¢‹ì•„ìš” ì·¨ì†Œ")
    @ApiResponses({
            @ApiResponse(code = 200, message = "í”¼ë“œë¥¼ ì„±ê³µì ìœ¼ë¡œ ì‹¤í–‰í–ˆìŠµë‹ˆë‹¤."),
            @ApiResponse(code = 400, message = "ìš”ì²­í•œ í”¼ë“œê°€ ì—†ê±°ë‚˜, ì¢‹ì•„ìš” ìƒíƒœê°€ ì•„ë‹™ë‹ˆë‹¤."),
            @ApiResponse(code = 500, message = "ì„œë²„ì—ëŸ¬ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.")
    })
    @DeleteMapping({"/{feed_id}/likes"})                         // REST: Document + Collection [Delete]
    public ResponseEntity<?> unlikeFeed(@PathVariable Long feed_id) {
        return likeService.undoLikeFeed(feed_id);
    }
}
```



#### < Service > 

> ëŒ€í‘œ : ì¢‹ì•„ìš” ì·¨ì†Œ, ì´ì™¸ Feed ì°¸ì¡°

##### ì¢‹ì•„ìš” ì·¨ì†Œ

```java
@Transactional
public ResponseEntity<?> undoLikeFeed(Long feed_id) {

  // Get Feed
  Optional<Feed> optFeed = feedRepository.findById(feed_id);// Check Like Status
  if (!optFeed.isPresent()) {
    return new ResponseEntity<>(HttpStatus.BAD_REQUEST);     // ì¢‹ì•„ìš”ê°€ ì—†ë‹¤ë©´ ì˜ëª»ëœ ìš”ì²­ì²˜ë¦¬
  }

  Feed feed = optFeed.get();

  // Get User
  User me = commonService.getLoginUser();

  // Get Like
  Like like = likeRepository.findByUserAndFeed(me, feed);

  if (like != null) {

    likeRepository.delete(like);

    // Update Feed's like_cnt
    feed.setLikeCnt(feed.getLikeCnt() - 1);                     
    feedRepository.save(feed);

    return new ResponseEntity<>(HttpStatus.OK);
  } else {

    return new ResponseEntity<>(HttpStatus.BAD_REQUEST);
  }
}
```



## Comment

#### < Entity >

```java
@Entity
@Table(name = "comment")
@Data
@AllArgsConstructor
@NoArgsConstructor
@Builder
@ToString(callSuper = true)
@EqualsAndHashCode(callSuper = true)
public class Comment extends BaseTimeEntity {

    @Id
    @Column(name = "comment_id")
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    private Long commentId;

    @Column(name = "content")
    private String content;

    @ManyToOne(fetch = FetchType.LAZY)
    @JoinColumn(name = "user_id")
    private User user;

    @ManyToOne(fetch = FetchType.LAZY)
    @JoinColumn(name = "feed_id")
    private Feed feed;
}
```





#### < DTO >

```java
@Getter
@Setter
@Builder
@AllArgsConstructor
@NoArgsConstructor
public class CommentListDto {

    @ApiParam(value = "ëŒ“ê¸€ id")
    private Long commentId;

    @ApiParam(value = "í”„ë¡œí•„ì‚¬ì§„")
    private String profileUrl;

    @ApiParam(value = "ìœ ì €ì´ë©”ì¼")
    private String email;

    @ApiParam(value = "ìœ ì €ì´ë¦„")
    private String username;

    @ApiParam(value = "ëŒ“ê¸€ë‚´ìš©")
    private String content;

    @ApiParam(value = "ëŒ“ê¸€ ì‘ì„± ì‹œê°")
    private LocalDateTime createdAt;

}
```



#### < Repository >

```java
public interface CommentRepository extends JpaRepository<Comment, Long> {

    List<Comment> findByFeed(Feed feed);
```

